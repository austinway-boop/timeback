<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlphaLearn - Course Editor</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" as="style">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="preload" href="/css/style.css?v=9" as="style">
    <link rel="stylesheet" href="/css/style.css?v=9">
    <link rel="stylesheet" href="/css/admin/course-editor.css?v=9">
</head>
<body data-view="admin" data-active="course-editor">

    <div class="layout">
        <nav class="sidebar" id="sidebar"></nav>
        <main class="main-content">
            <div class="admin-course-editor">
                <div class="page-header">
                    <h1 class="page-title"><i class="fa-solid fa-pen-ruler" style="margin-right:10px; opacity:0.7;"></i>Course Editor</h1>
                    <p class="page-subtitle">Generate AI-powered skill trees for AP courses</p>
                </div>

                <!-- Course List View -->
                <div id="course-list-view">
                    <div class="controls-bar">
                        <div class="search-box">
                            <i class="fa-solid fa-magnifying-glass search-icon"></i>
                            <input type="text" id="course-search" class="search-input" placeholder="Search AP courses...">
                        </div>
                    </div>
                    <div class="results-info"><span id="courses-count">Loading courses...</span></div>
                    <div class="ce-course-grid" id="courses-grid"></div>
                </div>

                <!-- Course Detail / Editor View -->
                <div id="course-detail-view" style="display:none;">
                    <button class="back-btn" id="back-btn">
                        <i class="fa-solid fa-arrow-left"></i> Back to courses
                    </button>

                    <div class="ce-detail-header" id="detail-header"></div>

                    <!-- Course Actions (landing page) -->
                    <div id="course-actions"></div>

                    <!-- Setup Wizard (hidden until "Setup" clicked) -->
                    <div id="setup-wizard" style="display:none;">
                        <!-- Step 1: Skill Tree -->
                        <div class="ce-section">
                            <div class="ce-section-label">Step 1</div>
                            <h3 class="ce-section-title">Generate Skill Tree</h3>
                            <p class="ce-section-desc">Generate a comprehensive map of every micro-skill in this course and how they relate to each other as prerequisites.</p>
                            <div class="ce-actions" id="skill-tree-actions"></div>
                            <div class="ce-progress" id="generation-progress" style="display:none;"></div>
                            <div id="skill-tree-export" style="display:none;"></div>
                        </div>

                        <!-- Step 2: Lesson Mapping -->
                        <div class="ce-section" id="lesson-mapping-section" style="display:none;">
                            <div class="ce-section-label">Step 2</div>
                            <h3 class="ce-section-title">Map Lessons to Skills</h3>
                            <p class="ce-section-desc">
                                The skill tree above contains <strong>all</strong> the skills for the entire course.
                                This next step uses AI to figure out which specific skills are taught in each individual lesson.
                                This lets the system know exactly what a student should learn from each lesson, enabling
                                precise gap analysis and personalized learning paths.
                            </p>
                            <div id="lesson-mapping-actions"></div>
                            <div class="ce-progress" id="lesson-mapping-progress" style="display:none;"></div>
                            <div id="lesson-mapping-results" style="display:none;"></div>
                        </div>

                        <!-- Step 3: Question Analysis -->
                        <div class="ce-section" id="question-analysis-section" style="display:none;">
                            <div class="ce-section-label">Step 3</div>
                            <h3 class="ce-section-title">Analyze Questions</h3>
                            <p class="ce-section-desc">
                                Pull every question and answer choice for this course, along with the content students see,
                                and use AI to determine how each question relates to the skill tree. For each wrong answer,
                                the analysis reveals what specific knowledge gaps or misunderstandings it indicates.
                                This data powers personalized diagnostics.
                            </p>
                            <div id="question-analysis-actions"></div>
                            <div class="ce-progress" id="question-analysis-progress" style="display:none;"></div>
                            <div id="question-analysis-results" style="display:none;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="/js/auth-guard.js?v=3"></script>
    <script src="/js/layout.js?v=20"></script>
    <script src="/js/notifications.js?v=7"></script>
    <script src="/js/app.js?v=7"></script>
    <script src="/js/admin/course-editor.js?v=17"></script>
</body>
</html>
